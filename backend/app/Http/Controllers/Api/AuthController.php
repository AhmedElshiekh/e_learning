<?php
bolt_decrypt( __FILE__ , 'IdOBnT'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXEh0dHBcQ29udHJvbGxlcnNcQXBpOwoKdXNlIEFwcFxVc2VyOwp1c2UgSWxsdW1pbmF0ZVxIdHRwXFJlcXVlc3Q7CnVzZSBJbGx1bWluYXRlXFN1cHBvcnRcRmFjYWRlc1xBdXRoOwp1c2UgSWxsdW1pbmF0ZVxTdXBwb3J0XEZhY2FkZXNcVmFsaWRhdG9yOwp1c2UgQXBwXEh0dHBcQ29udHJvbGxlcnNcQ29udHJvbGxlcjsKdXNlIEFwcFxIdHRwXFRyYWl0c1xBcGlSZXNwb25zZVRyYWl0Owp1c2UgQXBwXEh0dHBcVHJhaXRzXEVtYWlsVmVyaWZ5VHJhaXQ7CnVzZSBBcHBcSHR0cFxUcmFpdHNcVHdpbGlvVHJhaXQ7CnVzZSBUd2lsaW9cUmVzdFxDbGllbnQ7CgpjbGFzcyBBdXRoQ29udHJvbGxlciBleHRlbmRzIENvbnRyb2xsZXIKewogICAgLyoqCiAgICAgKiBDcmVhdGUgYSBuZXcgQXV0aENvbnRyb2xsZXIgaW5zdGFuY2UuCiAgICAgKgogICAgICogQHJldHVybiB2b2lkCiAgICAgKi8KICAgIHVzZSBBcGlSZXNwb25zZVRyYWl0OwogICAgdXNlIEVtYWlsVmVyaWZ5VHJhaXQ7CiAgICAvLyB1c2UgVHdpbGlvVHJhaXQ7CgogICAgcHVibGljIGZ1bmN0aW9uIF9fY29uc3RydWN0KCkKICAgIHsKICAgICAgICAvLyAkdGhpcy0+bWlkZGxld2FyZSgnYXV0aDphcGknLCBbJ2V4Y2VwdCcgPT4gWydsb2dpbicsICdyZWdpc3RlciddXSk7CgogICAgICAgICR0aGlzLT5zaWQgICAgICAgICAgPSBjb25maWcoJ3R3aWxpby5hY2NvdW50X3NpZCcpOwogICAgICAgICR0aGlzLT50b2tlbiAgICAgICAgPSBjb25maWcoJ3R3aWxpby5hdXRoX3Rva2VuJyk7CiAgICAgICAgJHRoaXMtPm1lc3NhZ2luZyAgICA9IGNvbmZpZygndHdpbGlvLm1lc3NhZ2luZ19zaWQnKTsKICAgIH0KCgogICAgLyoqCiAgICAgKiBSZWdpc3RlciBuZXcgdXNlci4KICAgICAqCiAgICAgKiBAcmV0dXJuIFxJbGx1bWluYXRlXEh0dHBcSnNvblJlc3BvbnNlCiAgICAgKi8KICAgIHB1YmxpYyBmdW5jdGlvbiByZWdpc3RlcihSZXF1ZXN0ICRyZXF1ZXN0KQogICAgewogICAgICAgICR2YWxpZGF0ZSA9IFZhbGlkYXRvcjo6bWFrZSgkcmVxdWVzdC0+YWxsKCksIFsKICAgICAgICAgICAgJ25hbWUnICAgICAgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ3R5cGUnICAgICAgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ2VtYWlsJyAgICAgPT4gJ3JlcXVpcmVkfGVtYWlsfHVuaXF1ZTp1c2VycycsCiAgICAgICAgICAgICdwaG9uZScgICAgID0+ICdyZXF1aXJlZHx1bmlxdWU6dXNlcnMnLAogICAgICAgICAgICAncGFzc3dvcmQnICA9PiAncmVxdWlyZWR8bWluOjR8Y29uZmlybWVkJywKICAgICAgICBdKTsKICAgICAgICBpZiAoJHZhbGlkYXRlLT5mYWlscygpKSA6CiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+YXBpUmVzcG9uc2UobnVsbCwgNDIyLCAkdmFsaWRhdGUtPmVycm9ycygpKTsKICAgICAgICBlbmRpZjsKCiAgICAgICAgJHVzZXIgPSBuZXcgVXNlcjsKICAgICAgICAkdXNlci0+bmFtZSA9ICRyZXF1ZXN0LT5uYW1lOwogICAgICAgICR1c2VyLT5lbWFpbCA9ICRyZXF1ZXN0LT5lbWFpbDsKICAgICAgICAkdXNlci0+cGhvbmUgPSAkcmVxdWVzdC0+cGhvbmU7CiAgICAgICAgJHVzZXItPnR5cGUgPSAkcmVxdWVzdC0+dHlwZTsKICAgICAgICAkdXNlci0+cGFzc3dvcmQgPSBiY3J5cHQoJHJlcXVlc3QtPnBhc3N3b3JkKTsKICAgICAgICAkdXNlci0+c2F2ZSgpOwoKICAgICAgICBpZigkdXNlcik6CiAgICAgICAgICAgIC8vICR0aGlzLT5TZW5kVmVyaWZ5VG9rZW4oJHJlcXVlc3QtPnBob25lLCAkdXNlci0+aWQpOwogICAgICAgICAgICAkdGhpcy0+U2VuZFZlcmlmeVRva2VuKCRyZXF1ZXN0LT5lbWFpbCwgJHVzZXItPmlkKTsKCiAgICAgICAgICAgIC8vICRjcmVkZW50aWFscyA9IFsncGhvbmUnID0+ICRyZXF1ZXN0LT5nZXQoJ3Bob25lJyksICdwYXNzd29yZCc9PiRyZXF1ZXN0LT5nZXQoJ3Bhc3N3b3JkJyldOwogICAgICAgICAgICAvLyAkdG9rZW4gPSBBdXRoOjphdHRlbXB0KCRjcmVkZW50aWFscyk7CgogICAgICAgICAgICAkZGF0YSA9IFsKICAgICAgICAgICAgICAgICdrZXknICAgICAgICAgICA9PiAkdXNlci0+aWQsCiAgICAgICAgICAgICAgICAvLyAnYWNjZXNzX3Rva2VuJyAgPT4gJHRva2VuLAogICAgICAgICAgICAgICAgLy8gJ3Rva2VuX3R5cGUnICAgID0+ICdiZWFyZXInLAogICAgICAgICAgICAgICAgLy8gJ2V4cGlyZXNfaW4nICAgID0+IGF1dGg6OmZhY3RvcnkoKS0+Z2V0VFRMKCkgKiA2MCwKICAgICAgICAgICAgICAgICd0eXBlJyAgICAgICAgICA9PiAkdXNlci0+dHlwZSwKICAgICAgICAgICAgICAgICd2ZXJpZmllZCcgICAgICA9PiAkdXNlci0+dmVyaWZpZWQsCiAgICAgICAgICAgICAgICAnbmFtZScgICAgICAgICAgPT4gJHVzZXItPm5hbWUsCiAgICAgICAgICAgIF07CgogICAgICAgICAgICByZXR1cm4gJHRoaXMtPmFwaVJlc3BvbnNlKCRkYXRhLCAyMDAsICdzdWNjZXNzIHRvIGNyZWF0ZSBhY2NvdW50ICxzaG91bGQgdmVyaWZ5IHBob25lJyk7CiAgICAgICAgZW5kaWY7CgogICAgICAgIHJldHVybiAkdGhpcy0+YXBpUmVzcG9uc2UobnVsbCwgNDA0LCAncmVnaXN0ZXIgZmlsZWQnKTsKICAgIH0KCiAgICAvKioKICAgICAqIEdldCBhIEpXVCB2aWEgZ2l2ZW4gY3JlZGVudGlhbHMuCiAgICAgKgogICAgICogQHJldHVybiBcSWxsdW1pbmF0ZVxIdHRwXEpzb25SZXNwb25zZQogICAgICovCiAgICBwdWJsaWMgZnVuY3Rpb24gbG9naW4oUmVxdWVzdCAkcmVxdWVzdCkKICAgIHsKICAgICAgICAvLyAkY3JlZGVudGlhbHMgPSByZXF1ZXN0KFsnZW1haWwnLCAncGFzc3dvcmQnXSk7CiAgICAgICAgJHZhbGlkYXRlID0gVmFsaWRhdG9yOjptYWtlKCRyZXF1ZXN0LT5hbGwoKSwgWwogICAgICAgICAgICAnZW1haWwnICAgICAgICAgPT4gJ3JlcXVpcmVkX3dpdGhvdXQ6cGhvbmV8ZW1haWx8bWF4OjI1NScsCiAgICAgICAgICAgICdwaG9uZScgICAgICAgICA9PiAncmVxdWlyZWRfd2l0aG91dDplbWFpbHxtaW46OScsCiAgICAgICAgICAgICdwYXNzd29yZCcgICAgICA9PiAncmVxdWlyZWR8bWF4OjI1fG1pbjo2JywKICAgICAgICBdKTsKICAgICAgICBpZiAoJHZhbGlkYXRlLT5mYWlscygpKSA6CiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+YXBpUmVzcG9uc2UobnVsbCwgNDIyLCAkdmFsaWRhdGUtPmVycm9ycygpKTsKICAgICAgICBlbmRpZjsKCgogICAgICAgIGlmKCRyZXF1ZXN0LT5pbnB1dCgnZW1haWwnKSl7CiAgICAgICAgICAgICRjcmVkZW50aWFscyA9IFsnZW1haWwnPT4kcmVxdWVzdC0+Z2V0KCdlbWFpbCcpLCdwYXNzd29yZCc9PiRyZXF1ZXN0LT5nZXQoJ3Bhc3N3b3JkJyldOwogICAgICAgICAgICAkZW1haWwgPSAkcmVxdWVzdC0+aW5wdXQoJ2VtYWlsJyk7CiAgICAgICAgICAgICR1c2VyID0gVXNlcjo6d2hlcmUoJ2VtYWlsJywgJHJlcXVlc3QtPmlucHV0KCdlbWFpbCcpKS0+Zmlyc3QoKTsKICAgICAgICB9CiAgICAgICAgZWxzZWlmICgkcmVxdWVzdC0+aW5wdXQoJ3Bob25lJykpIHsKICAgICAgICAgICAgJGNyZWRlbnRpYWxzID0gWydwaG9uZScgPT4gJHJlcXVlc3QtPmdldCgncGhvbmUnKSwgJ3Bhc3N3b3JkJz0+JHJlcXVlc3QtPmdldCgncGFzc3dvcmQnKV07CiAgICAgICAgICAgICR1c2VyID0gVXNlcjo6d2hlcmUoJ3Bob25lJywgJHJlcXVlc3QtPmlucHV0KCdwaG9uZScpKS0+Zmlyc3QoKTsKICAgICAgICAgICAgJGVtYWlsID0gJHVzZXItPmVtYWlsOwogICAgICAgIH0KCiAgICAgICAgaWYoJHVzZXIgJiYgJHVzZXItPnZlcmlmaWVkID09IGZhbHNlKToKICAgICAgICAgICAgJGRhdGEgPSBbJ3VzZXJfa2V5JyA9PiAkdXNlci0+aWRdOwogICAgICAgICAgICByZXR1cm4gJHRoaXMtPmFwaVJlc3BvbnNlKCRkYXRhLCA0MDMsICdZb3Ugc2hvdWxkIHZlcmlmeSB5b3UgcGhvbmUnKTsKICAgICAgICBlbmRpZjsKCgogICAgICAgIC8vIGRkKCRjcmVkZW50aWFscyk7CiAgICAgICAgaWYgKCEkdG9rZW4gPSBBdXRoOjphdHRlbXB0KCRjcmVkZW50aWFscykpIHsKCiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+YXBpUmVzcG9uc2UobnVsbCwgNDAxLCAnVGhlIHBhc3N3b3JkIG9yIGVtYWlsIGlzIGZhaWxlZCcpOwogICAgICAgIH0KCiAgICAgICAgLy8gJGVtYWlsID0gYXV0aAogICAgICAgIHJldHVybiAkdGhpcy0+cmVzcG9uZFdpdGhUb2tlbigkdG9rZW4sICRlbWFpbCk7CiAgICB9CgoKCiAgICBwdWJsaWMgZnVuY3Rpb24gdmVyaWZpY2F0aW9uKFJlcXVlc3QgJHJlcXVlc3QsICR1aWQpCiAgICB7CiAgICAgICAgJHZhbGlkYXRlID0gVmFsaWRhdG9yOjptYWtlKCRyZXF1ZXN0LT5hbGwoKSwgWwogICAgICAgICAgICAnY29kZScgICA9PiAncmVxdWlyZWR8bnVtZXJpY3xkaWdpdHM6NicsCiAgICAgICAgXSk7CgogICAgICAgIGlmICgkdmFsaWRhdGUtPmZhaWxzKCkpIDoKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5hcGlSZXNwb25zZShudWxsLCA0MjIsICR2YWxpZGF0ZS0+ZXJyb3JzKCkpOwogICAgICAgIGVuZGlmOwoKICAgICAgICAkdXNlciA9IFVzZXI6OmZpbmQoJHVpZCk7CiAgICAgICAgJGNoZWNrID0gJHRoaXMtPkNoZWNrVmVyaWZ5VG9rZW4oJHVzZXItPmVtYWlsLCAkcmVxdWVzdC0+Y29kZSk7CgogICAgICAgIGlmKCRjaGVjayk6CiAgICAgICAgICAgICR1c2VyLT52ZXJpZmllZCA9IHRydWU7CiAgICAgICAgICAgICR1c2VyLT52ZXJpZnlfbXNnLT5kZWxldGUoKTsKICAgICAgICAgICAgJHVzZXItPnNhdmUoKTsKCiAgICAgICAgICAgICR0b2tlbiA9IEF1dGg6OmZyb21Vc2VyKCR1c2VyKTsKICAgICAgICAgICAgJGRhdGEgPSBbCiAgICAgICAgICAgICAgICAna2V5JyAgICAgICAgICAgPT4gJHVzZXItPmlkLAogICAgICAgICAgICAgICAgJ2FjY2Vzc190b2tlbicgID0+ICR0b2tlbiwKICAgICAgICAgICAgICAgICd0b2tlbl90eXBlJyAgICA9PiAnYmVhcmVyJywKICAgICAgICAgICAgICAgICdleHBpcmVzX2luJyAgICA9PiBhdXRoOjpmYWN0b3J5KCktPmdldFRUTCgpICogNjAsCiAgICAgICAgICAgICAgICAndHlwZScgICAgICAgICAgPT4gJHVzZXItPnR5cGUsCiAgICAgICAgICAgICAgICAndmVyaWZpZWQnICAgICAgPT4gJHVzZXItPnZlcmlmaWVkLAogICAgICAgICAgICAgICAgJ25hbWUnICAgICAgICAgID0+ICR1c2VyLT5uYW1lLAogICAgICAgICAgICBdOwoKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5hcGlSZXNwb25zZSgkZGF0YSwgMjAwLCAnVGhhbmtzIGZvciB2ZXJpZnkgeW91ciBwaG9uZScpOwogICAgICAgIGVuZGlmOwoKICAgICAgICByZXR1cm4gJHRoaXMtPmFwaVJlc3BvbnNlKG51bGwsIDQwMSwgJ1RoZSB2ZXJpZnkgZmFpbGVkJyk7CiAgICB9CgoKCiAgICBwdWJsaWMgZnVuY3Rpb24gcmVzZW5kVmVyaWZ5Q29kZSgkdWlkKQogICAgewogICAgICAgICRzZW5kID0gJHRoaXMtPlJlc2VuZFZlcmlmeVRva2VuKCR1aWQpOwoKICAgICAgICBpZigkc2VuZCA9PSB0cnVlKToKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5hcGlSZXNwb25zZShudWxsLCAyMDApOwogICAgICAgIGVuZGlmOwoKICAgICAgICByZXR1cm4gJHRoaXMtPmFwaVJlc3BvbnNlKG51bGwsIDQwMSwgJ3NlbmQgY29kZSBmYWlsZWQnKTsKICAgIH0KCgogICAgLyoqCiAgICAgKiBMb2cgdGhlIHVzZXIgb3V0IChJbnZhbGlkYXRlIHRoZSB0b2tlbikuCiAgICAgKgogICAgICogQHJldHVybiBcSWxsdW1pbmF0ZVxIdHRwXEpzb25SZXNwb25zZQogICAgICovCiAgICBwdWJsaWMgZnVuY3Rpb24gbG9nb3V0KCkKICAgIHsKICAgICAgICBpZiAoQXV0aDo6Y2hlY2soKSkgOgogICAgICAgICAgICBBdXRoOjpsb2dvdXQoKTsKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5hcGlSZXNwb25zZShudWxsLCAyMDAsICdTdWNjZXNzZnVsbHkgbG9nZ2VkIG91dCcpOwogICAgICAgIGVuZGlmOwoKICAgICAgICAvLyBpZiBhbGwgZmFpbGVkIHJldHVybiBlcnJvciA1MjAKICAgICAgICByZXR1cm4gJHRoaXMtPmFwaVJlc3BvbnNlKG51bGwsIDUyMCwgJ1VuIEtub3cgRXJyb3InKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlZnJlc2ggYSB0b2tlbi4KICAgICAqCiAgICAgKiBAcmV0dXJuIFxJbGx1bWluYXRlXEh0dHBcSnNvblJlc3BvbnNlCiAgICAgKi8KICAgIHB1YmxpYyBmdW5jdGlvbiBhdXRoQ2hlY2soKQogICAgewogICAgICAgIGlmIChBdXRoOjpjaGVjaygpKSA6CiAgICAgICAgICAgICRkYXRhID0gWyAndG9rZW5fd29yaycgICAgPT4gIHRydWVdOwogICAgICAgICAgICByZXR1cm4gJHRoaXMtPmFwaVJlc3BvbnNlKCRkYXRhLCAyMDAsICdZb3UgYXJlIGxvZ2luJyk7CiAgICAgICAgZW5kaWY7CgogICAgICAgICRkYXRhID0gWyAndG9rZW5fd29yaycgICAgPT4gIGZhbHNlIF07CiAgICAgICAgLy8gaWYgYWxsIGZhaWxlZCByZXR1cm4gZXJyb3IgNTIwCiAgICAgICAgcmV0dXJuICR0aGlzLT5hcGlSZXNwb25zZSgkZGF0YSwgMjAwLCAncGxlYXNlLCBsb2dpbicpOwogICAgfQoKICAgIC8qKgogICAgICogR2V0IHRoZSB0b2tlbiBhcnJheSBzdHJ1Y3R1cmUuCiAgICAgKgogICAgICogQHBhcmFtICBzdHJpbmcgJHRva2VuCiAgICAgKgogICAgICogQHJldHVybiBcSWxsdW1pbmF0ZVxIdHRwXEpzb25SZXNwb25zZQogICAgICovCiAgICBwcm90ZWN0ZWQgZnVuY3Rpb24gcmVzcG9uZFdpdGhUb2tlbigkdG9rZW4sICRlbWFpbCkKICAgIHsKICAgICAgICAkdXNlciA9IFVzZXI6OndoZXJlKCdlbWFpbCcsICRlbWFpbCktPmZpcnN0KCk7CiAgICAgICAgLy8gZGQoJHVzZXIpOwogICAgICAgICRkYXRhID0gWwogICAgICAgICAgICAna2V5JyAgICAgICAgICAgPT4gJHVzZXItPmlkLAogICAgICAgICAgICAnYWNjZXNzX3Rva2VuJyAgPT4gJHRva2VuLAogICAgICAgICAgICAndG9rZW5fdHlwZScgICAgPT4gJ2JlYXJlcicsCiAgICAgICAgICAgICdleHBpcmVzX2luJyAgICA9PiBhdXRoOjpmYWN0b3J5KCktPmdldFRUTCgpICogNjAsCiAgICAgICAgICAgICd0eXBlJyAgICAgICAgICA9PiAkdXNlci0+dHlwZSwKICAgICAgICAgICAgJ25hbWUnICAgICAgICAgID0+ICR1c2VyLT5uYW1lLAogICAgICAgIF07CgogICAgICAgIHJldHVybiAkdGhpcy0+YXBpUmVzcG9uc2UoJGRhdGEsIDIwMCk7CiAgICB9Cn0K